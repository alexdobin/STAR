***********************
***** STAR-Fusion *****
*********************** contributed by Brian Haas, Broad Institute, 2015

STAR-Fusion further processes the output generated by the STAR aligner to map junction reads and spanning reads to a reference annotation set (using a GTF file, ideally the same annotation file used during the STAR genome index building process during the intial STAR setup).


STAR should be run using options that are well suited to fusion read detection.  An example of settings similar to those used in the landmark publication "The landscape of kinase fusions in cancer" (PMID: 25204415) by Stransky et al., Nat Commun 2014 are as follows:


   STAR --genomeDir Hg19.fa_star_index \
        --readFilesIn left.fq right.fq \
        --outSAMstrandField intronMotif \
        --outFilterIntronMotifs RemoveNoncanonicalUnannotated \
        --outReadsUnmapped None --chimSegmentMin 15 \
        --chimJunctionOverhangMin 15 \
        --alignMatesGapMax 200000 \
        --alignIntronMax 200000 \
        --outSAMtype BAM SortedByCoordinate 


The output from running star will include two primary output files that contain the junction and spanning read information (see STAR documentation for precise details).

      Chimeric.out.junction  : contains junction reads.
	  Chimeric.out.sam : contains alignments for fusion-spanning reads.


###############################
## Installation Requirements ##
###############################

  STAR-Fusion requires the following Perl module from CPAN : Set/IntervalTree.pm
  found here:
  http://search.cpan.org/~benbooth/Set-IntervalTree-0.02/lib/Set/IntervalTree.pm

  A typical perl module installation may involve:
  perl -MCPAN -e shell
    install Set::IntervalTree 
 	
  *This CPAN module tends to install trouble-free on Linux.  Note, if you have trouble installing Set::IntervalTree on Mac OS X (as I did), try the following:  download the tarball from the above, run the perl Makefile.pl, then edit the generated 'Makefile' and remove all occurrences of '-arch i386'. Then try 'make', 'make test', and finally 'make install'.


#########################
## Running STAR-Fusion ##
#########################

Run STAR-Fusion like so, using these two files above in addition to specifiying the reference genome annotation GTF file:

      STAR-Fusion -S Chimeric.out.sam -J Chimeric.out.junction -G ref_annot.gtf


The output from STAR-Fusion is found as a tab-delimited file named 'star-fusion.fusion_candidates.txt', and has the following format:

#fusion_name	JunctionReads	SpanningReads	LeftGene	LeftBreakpoint	RightGene	RightBreakpoint
RBX1--HAPLN2    135     1385    RBX1    chr22:41363889  HAPLN2  chr1:156593258
UNC119--PCSK1   132     386     UNC119  chr17:26879355  PCSK1   chr5:95734741
MICAL1--TMEM198B        131     743     MICAL1  chr6:109767898  TMEM198B        chr12:56227230
...



Note, these fusion candidates are derived solely on mapping the STAR outputs to the reference annotations.  No additional filtering is performed.  Paralogous genes are notorious for showing up as false-positive fusion candidates. Additional filtering tools, although not included now, will be made available soon.  Even without additional filtering, STAR-Fusion provides fusion detection accuracy that is on par with the very best available fusion predictors, and is one of the most efficient.


##############################
## Example data and execution:
##############################

In the included test/ directory, you'll find a 'runMe.sh' script along with a data/ subdirectory.  The data/ subdirectory contains example fusion and spanning data generated from running STAR, in addition to a reference annotation file for gencode v19. Note, the reference GTF file contains only the 'exon' records instead of all lines from the original gencode annotation file; this speeds up parsing of the file and keeps the file size relatively small for including in this package.

In this test/ directory, Run the sample execution like so:

    ./runMe.sh

which simply runs:

    ../STAR-Fusion -S data/Chimeric.out.sam.gz -J data/Chimeric.out.junction.gz -G data/gencode.v19.rna_seq_pipeline.gtf.exons.gz

and you'll find the output file 'star-fusion.fusion_candidates.txt' containing the fusion candidates in the format described above.



